package util

import (
	"github.com/minio/highwayhash"
)

var KEY = []byte{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
}

func Hash32(data []byte) uint32 {
	return uint32(highwayhash.Sum64(data, KEY))
}

func Hash64(data []byte) uint64 {
	return highwayhash.Sum64(data, KEY)
}

func Near(n uint64) uint64 {
	n--
	n |= n >> 1
	n |= n >> 2
	n |= n >> 4
	n |= n >> 8
	n |= n >> 16
	n |= n >> 32
	n++

	return n
}
